<!doctype html>
<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <title>twilio-client Demo</title>

  <script src="../../platform/platform.js"></script>
  <script src="namesgenerator.js"></script>
  <link rel="import" href="../../cachable-ajax/cachable-ajax.html">
  <link rel="import" href="../twilio-client.html">

  <link href="styles.css" type="text/css" rel="stylesheet" />

</head>
<body unresolved>

<cachable-ajax url="/capability" params='{"clientName":"promiseClient"}' handleAs="text"></cachable-ajax>
<twilio-client></twilio-client>

<input class="number" type="text"
       placeholder="Enter a phone number to call"/>

<button class="call" on-click="{{call}}">
  Call
</button>

<button class="hangup" on-click="{{hangUp}}">
  Hang Up
</button>

<button class="anykey" on-click="{{anyKey}}">
  Any Key
</button>


<script>
  var ajax = document.querySelector('cachable-ajax');
  var client = document.querySelector('twilio-client');

  document.addEventListener('polymer-ready', function () {
    var callButton = document.querySelector('.call');
    var hangUpButton = document.querySelector('.hangup');
    var anyKeyButton = document.querySelector('.anykey');
    callButton.onclick = function () {
      var number = document.querySelector('.number').value;
      client.call(number);
    };

    hangUpButton.onclick = client.hangUp;
    anyKeyButton.onclick = client.anyKey;

    var promise = ajax.go();
    client.capabilityToken = promise;
    client.init();
  });
</script>
</body>
</html>
